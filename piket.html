<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ðŸ“‹ Absensi Piket Kelas Siang</title>

<!-- Font Menarik -->
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">

<style>
  :root {
    --bg-light: #f6f9fc;
    --bg-dark: #0b0f19;
    --text-light: #1c1c1c;
    --text-dark: #f8f8f8;
    --accent: #007bff;
    --card-light: #ffffff;
    --card-dark: #1a1f2a;
  }

  body {
    font-family: 'Quicksand', sans-serif;
    background-color: var(--bg-light);
    color: var(--text-light);
    margin: 0;
    padding: 20px;
    transition: all 0.5s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    background-image: linear-gradient(135deg, #e3f2fd, #fff);
    min-height: 100vh;
  }

  .dark {
    background-color: var(--bg-dark);
    background-image: linear-gradient(135deg, #0f172a, #1e293b);
    color: var(--text-dark);
  }

  .container {
    background: var(--card-light);
    padding: 25px;
    border-radius: 20px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.1);
    max-width: 480px;
    width: 90%;
    text-align: center;
    transition: all 0.4s ease;
    animation: fadeIn 1s ease forwards;
  }

  .dark .container {
    background: var(--card-dark);
    box-shadow: 0 8px 25px rgba(255,255,255,0.05);
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(15px); }
    to { opacity: 1; transform: translateY(0); }
  }

  h1 {
    color: var(--accent);
    margin-bottom: 10px;
    letter-spacing: 1px;
  }

  input, select, button {
    margin: 8px;
    padding: 10px;
    width: 90%;
    border-radius: 10px;
    border: 1px solid #ccc;
    font-size: 15px;
    font-family: 'Quicksand', sans-serif;
  }

  input, select {
    background-color: rgba(255, 255, 255, 0.8);
  }

  button {
    background-color: var(--accent);
    color: white;
    font-weight: 600;
    border: none;
    cursor: pointer;
    transition: 0.3s;
  }

  button:hover {
    transform: scale(1.05);
    background-color: #0056cc;
  }

  video, canvas {
    width: 90%;
    border-radius: 10px;
    margin-top: 10px;
  }

  #notif {
    background: #ffeb3b;
    padding: 8px;
    border-radius: 8px;
    margin-top: 10px;
    display: none;
    font-weight: 600;
    color: #000;
  }

  .dark #notif {
    background: #ffd54f;
    color: #000;
  }

  .absen-card {
    border-left: 5px solid var(--accent);
    background: rgba(0,0,0,0.03);
    margin-top: 10px;
    padding: 10px;
    border-radius: 10px;
    text-align: left;
  }

  .dark .absen-card {
    background: rgba(255,255,255,0.08);
  }

  .absen-card img {
    margin-top: 8px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  }

  footer {
    margin-top: 15px;
    font-size: 13px;
    opacity: 0.8;
  }
</style>
</head>

<body>
  <div class="container">
    <h1>ðŸ“‹ Absensi Piket Kelas Siang</h1>
    <p><b>Waktu Piket:</b> 15:00 - 16:00 WIB</p>
    <p id="clock"></p>
    <p id="date"></p>

    <input type="text" id="nama" placeholder="Masukkan nama"><br>
    <select id="jenis">
      <option value="Membersihkan Kelas">Membersihkan Kelas</option>
      <option value="Menyapu">Menyapu</option>
      <option value="Mengepel">Mengepel</option>
      <option value="Merapikan Meja">Merapikan Meja</option>
      <option value="Menghapus Papan Tulis">Menghapus Papan Tulis</option>
    </select><br>
    <input type="text" id="guru" placeholder="Guru terakhir mengajar"><br>
    <input type="text" id="mapel" placeholder="Mata pelajaran terakhir"><br>

    <button onclick="startCamera()">ðŸŽ¥ Nyalakan Kamera</button>
    <video id="video" autoplay playsinline></video>
    <canvas id="canvas" style="display:none;"></canvas>

    <button onclick="ambilFoto()">ðŸ“¸ Ambil Foto & Absen</button>
    <button onclick="toggleTheme()">ðŸŒ“ Ganti Tema</button>

    <div id="notif"></div>
    <div id="hasil"></div>

    <footer>âœ¨ Absensi Digital Â© 2025 | Mode Terang/Gelap Otomatis âœ¨</footer>
  </div>

<script>
  const video = document.getElementById("video");
  const canvas = document.getElementById("canvas");
  const notif = document.getElementById("notif");
  const hasil = document.getElementById("hasil");

  // Jam & tanggal real-time
  setInterval(() => {
    const now = new Date();
    document.getElementById("clock").textContent = `â° ${now.toLocaleTimeString()}`;
    document.getElementById("date").textContent = now.toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
  }, 1000);

  // Notifikasi pop-up
  function notify(msg) {
    notif.textContent = msg;
    notif.style.display = "block";
    setTimeout(() => notif.style.display = "none", 4000);
  }

  // Kamera aktif
  async function startCamera() {
    try {
      const stream = await navigator.mediaDevices.getUserMedia({ video: true });
      video.srcObject = stream;
      notify("ðŸ“¸ Kamera aktif, siap mengambil foto.");
    } catch (error) {
      notify("ðŸš« Gagal mengakses kamera. Periksa izin kamera.");
    }
  }

  // Ambil foto dan absensi
  function ambilFoto() {
    const nama = document.getElementById("nama").value;
    const jenis = document.getElementById("jenis").value;
    const guru = document.getElementById("guru").value;
    const mapel = document.getElementById("mapel").value;
    const waktu = new Date();
    const jam = waktu.getHours();
    let status = "";

    if (jam < 15) status = "âŒ Belum waktu piket";
    else if (jam >= 15 && jam < 16) status = "âœ… Tepat waktu";
    else status = "âš ï¸ Terlambat";

    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    canvas.getContext("2d").drawImage(video, 0, 0);
    const fotoData = canvas.toDataURL("image/png");

    const entry = document.createElement("div");
    entry.classList.add("absen-card");
    entry.innerHTML = `
      <p><b>${nama}</b> (${jenis}) - ${waktu.toLocaleTimeString()}</p>
      <p>Status: ${status}</p>
      <p>Guru Terakhir: ${guru}</p>
      <p>Mapel Terakhir: ${mapel}</p>
      <img src="${fotoData}" alt="Foto ${nama}">
    `;
    hasil.prepend(entry);
    notify(`âœ… ${nama} berhasil absen (${status})`);
  }

  // Tema gelap / terang
  function toggleTheme() {
    document.body.classList.toggle("dark");
  }
</script>
</body>
</html>
